import{N as be,d as te,O as xe,A as Y,P as we,Q as Se,R as se,S as ke,T as ne,U as $e,V as Ce,W as J,x as Ae,y as Ve,u as Be,X as De,Y as Ee,s as I,H as Me,o as m,c as f,e,g as L,n as Te,F as z,b as l,f as Ie,i as s,t as u,w as _,j as R,k as Pe,l as Ue,Z as ze,p as Ne,$ as B,a0 as q,a1 as Oe,h as y,a2 as Q,a3 as X,a4 as ee,a5 as Ge}from"./D2h1M-6X.js";import{_ as Re}from"./DvU2Yq2X.js";import{u as je,l as Le,_ as qe,a as Fe,b as He,c as We,d as Ze,e as Ke}from"./CsQFPYKN.js";import{u as Ye}from"./hrPMgQTE.js";import{_ as Je,a as Qe,b as Xe}from"./DmHgsjQb.js";import{g as et}from"./Bk_rJcZu.js";import"./GQHXd0SH.js";import"./CTsXp8GV.js";import"./DM4cFtrS.js";import"./5Eo_AKUy.js";const tt={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"};function st(){return tt}const nt={name:"Space",self:st};let F;function at(){if(!be)return!0;if(F===void 0){const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.rowGap="1px",i.appendChild(document.createElement("div")),i.appendChild(document.createElement("div")),document.body.appendChild(i);const d=i.scrollHeight===1;return document.body.removeChild(i),F=d}return F}const ot=Object.assign(Object.assign({},se.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemClass:String,itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),lt=te({name:"Space",props:ot,setup(i){const{mergedClsPrefixRef:d,mergedRtlRef:D}=Se(i),g=se("Space","-space",void 0,nt,i,d),v=ke("Space",D,d);return{useGap:at(),rtlEnabled:v,mergedClsPrefix:d,margin:ne(()=>{const{size:p}=i;if(Array.isArray(p))return{horizontal:p[0],vertical:p[1]};if(typeof p=="number")return{horizontal:p,vertical:p};const{self:{[$e("gap",p)]:P}}=g.value,{row:b,col:o}=Ce(P);return{horizontal:J(o),vertical:J(b)}})}},render(){const{vertical:i,reverse:d,align:D,inline:g,justify:v,itemClass:p,itemStyle:P,margin:b,wrap:o,mergedClsPrefix:E,rtlEnabled:n,useGap:w,wrapItem:j,internalUseGap:H}=this,C=xe(et(this),!1);if(!C.length)return null;const M=`${b.horizontal}px`,T=`${b.horizontal/2}px`,k=`${b.vertical}px`,x=`${b.vertical/2}px`,$=C.length-1,A=v.startsWith("space-");return Y("div",{role:"none",class:[`${E}-space`,n&&`${E}-space--rtl`],style:{display:g?"inline-flex":"flex",flexDirection:i&&!d?"column":i&&d?"column-reverse":!i&&d?"row-reverse":"row",justifyContent:["start","end"].includes(v)?`flex-${v}`:v,flexWrap:!o||i?"nowrap":"wrap",marginTop:w||i?"":`-${x}`,marginBottom:w||i?"":`-${x}`,alignItems:D,gap:w?`${b.vertical}px ${b.horizontal}px`:""}},!j&&(w||H)?C:C.map((U,S)=>U.type===we?U:Y("div",{role:"none",class:p,style:[P,{maxWidth:"100%"},w?"":i?{marginBottom:S!==$?k:""}:n?{marginLeft:A?v==="space-between"&&S===$?"":T:S!==$?M:"",marginRight:A?v==="space-between"&&S===0?"":T:"",paddingTop:x,paddingBottom:x}:{marginRight:A?v==="space-between"&&S===$?"":T:S!==$?M:"",marginLeft:A?v==="space-between"&&S===0?"":T:"",paddingTop:x,paddingBottom:x}]},U)))}}),it={class:"flex flex-col h-full"},rt={key:0,class:"flex flex-col items-center justify-center flex-1 mb-12"},ct={class:"text-2xl font-bold mb-2"},ut={class:"text-gray-400 mb-4"},mt={class:"sticky top-0 myglass flex items-center justify-center py-2"},pt={class:"grid w-full my-2 max-w-2xl gap-8 checkout-form flex-1"},dt={key:0},ft={class:"w-full mb-2 text-2xl font-semibold leading-none"},gt={class:"mt-1 text-sm text-gray-500"},_t={href:"/my-account",class:"text-primary text-semibold"},ht={class:"w-full mt-4"},yt={for:"email"},vt={key:0,class:"mt-1 text-sm text-red-500"},bt={class:"w-full mt-4"},xt={for:"username"},wt={key:0,class:"w-full my-2"},St={for:"email"},kt={key:1,class:"flex items-center gap-2 my-2"},$t={for:"creat-account"},Ct={class:"w-full mb-3 text-2xl font-semibold"},At={for:"shipToDifferentAddress",class:"flex items-center gap-2"},Vt={class:"mb-4 text-xl font-semibold"},Bt={key:0},Dt={class:"mb-4 text-xl font-semibold"},Et={key:0,class:"mt-2 col-span-full"},Mt={class:"mb-4 text-xl font-semibold"},Tt={class:"mb-4 text-xl font-semibold"},It=["placeholder"],Pt=["disabled"],Ht=te({__name:"ch",async setup(i){var Z;let d,D;const{t:g}=Ae(),{query:v}=Ve(),{cart:p,isUpdatingCart:P,paymentGateways:b}=Be(),{customer:o,viewer:E}=De(),{orderInput:n,isProcessingOrder:w,proccessCheckout:j}=je(),C=((Z=Ee().public)==null?void 0:Z.STRIPE_PUBLISHABLE_KEY)||null,M=I(w.value?g("messages.general.processing"):g("messages.shop.checkoutButton")),T=ne(()=>w.value||P.value||!n.value.paymentMethod),k=I(!1),x=C?([d,D]=Me(()=>Le(C)),d=await d,D(),d):null;let $=I(null);const A=I(!1),U=async()=>{var t;M.value=g("messages.general.processing");try{const{stripePaymentIntent:a}=await ze(),{clientSecret:N}=a;if(n.value.paymentMethod.id==="stripe"){const O=$.value.getElement("card"),{setupIntent:V}=await x.confirmCardSetup(N,{payment_method:{card:O}}),{source:h}=await x.createSource(O);h&&n.value.metaData.push({key:"_stripe_source_id",value:h.id}),V&&n.value.metaData.push({key:"_stripe_intent_id",value:V.id}),A.value=(V==null?void 0:V.status)==="succeeded"||!1,n.value.transactionId=((t=h==null?void 0:h.created)==null?void 0:t.toString())||new Date().getTime().toString()}}catch(a){console.error(a),M.value=g("messages.shop.placeOrder")}j(A.value)},S=t=>{$.value=t},W=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,ae=t=>{t&&(k.value=!W.test(t))},oe=t=>{t&&k.value&&(k.value=!W.test(t))};Ye({title:g("messages.shop.checkout")});const r=I(E.value?2:1),le=I("process");function ie(){var t;if(r.value===1&&(!o.value.billing.email||k.value))return alert(g("messages.error.invalidEmail")),!1;if(r.value===2){if(!((t=o.value.billing)!=null&&t.firstName)||!o.value.billing.lastName||!o.value.billing.address1||!o.value.billing.city||!o.value.billing.postcode||!o.value.billing.country)return alert(g("messages.error.missingBillingDetails")),!1;if(n.shipToDifferentAddress&&(!o.value.shipping.firstName||!o.value.shipping.lastName||!o.value.shipping.address1||!o.value.shipping.city||!o.value.shipping.postcode||!o.value.shipping.country))return alert(g("messages.error.missingShippingDetails")),!1}return r.value===3&&(!n.value.paymentMethod||!n.value.paymentMethod.id)?(alert(g("messages.error.missingPaymentMethod")),!1):!0}function re(){ie()&&(r.value===null?r.value=1:r.value>=4?r.value=null:r.value++)}function ce(){r.value===0?r.value=null:r.value===null?r.value=4:r.value--}return(t,a)=>{const N=Te,O=Ie,V=Pe,h=Ne,G=Je,ue=Qe,me=Re,pe=qe,de=Fe,fe=He,ge=We,_e=Ze,he=Ke,K=Ge,ye=Xe,ve=lt;return m(),f("div",it,[e(p)?(m(),f(z,{key:1},[e(p).isEmpty?(m(),f("div",rt,[l(O,{name:"ion:cart-outline",size:"156",class:"opacity-25 mb-5"}),s("h2",ct,u(t.$t("messages.shop.cartEmpty")),1),s("span",ut,u(t.$t("messages.shop.addProductsInYourCart")),1),l(V,{to:"/products",class:"flex items-center justify-center gap-3 p-2 px-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark"},{default:_(()=>[R(u(t.$t("messages.shop.browseOurProducts")),1)]),_:1})])):(m(),f("form",{key:1,class:"mx-4 flex-1 flex flex-col h-full relative",onSubmit:Ue(U,["prevent"])},[s("div",mt,[l(ue,{class:"ml-8",current:e(r),status:e(le)},{default:_(()=>[l(G,null,{icon:_(()=>[l(h,{icon:"ion:home",class:"text-white"})]),_:1}),l(G,null,{icon:_(()=>[l(h,{icon:"ion:person"})]),_:1}),l(G,null,{icon:_(()=>[l(h,{icon:"ion:card"})]),_:1}),l(G,null,{icon:_(()=>[l(h,{icon:"ion:checkmark-circle"})]),_:1})]),_:1},8,["current","status"])]),s("div",pt,[!e(E)&&e(r)==1?(m(),f("div",dt,[s("h2",ft,u(t.$t("messages.account.emailOrUsername")),1),s("p",gt,[R(u(t.$t("messages.account.hasAccount"))+" ",1),s("a",_t,u(t.$t("messages.account.login")),1),a[11]||(a[11]=R("."))]),s("div",ht,[s("label",yt,u(t.$t("messages.billing.email")),1),B(s("input",{"onUpdate:modelValue":a[0]||(a[0]=c=>e(o).billing.email=c),placeholder:"johndoe@email.com",type:"email",name:"email",class:Oe({"has-error":e(k)}),onBlur:a[1]||(a[1]=c=>ae(e(o).billing.email)),onInput:a[2]||(a[2]=c=>oe(e(o).billing.email)),required:""},null,34),[[q,e(o).billing.email]]),l(Q,{name:"scale-y",mode:"out-in"},{default:_(()=>[e(k)?(m(),f("div",vt,u(t.$t("messages.error.general")),1)):y("",!0)]),_:1})]),e(n).createAccount?(m(),f(z,{key:0},[s("div",bt,[s("label",xt,u(t.$t("messages.account.username")),1),B(s("input",{"onUpdate:modelValue":a[3]||(a[3]=c=>e(n).username=c),placeholder:"Username",type:"text",name:"username",required:""},null,512),[[q,e(n).username]])]),e(n).createAccount?(m(),f("div",wt,[s("label",St,u(t.$t("messages.account.password")),1),l(me,{id:"password",class:"my-2",modelValue:e(n).password,"onUpdate:modelValue":a[4]||(a[4]=c=>e(n).password=c),placeholder:"Password",required:!0},null,8,["modelValue"])])):y("",!0)],64)):y("",!0),e(E)?y("",!0):(m(),f("div",kt,[s("label",$t,u(t.$t("messages.account.register")),1),B(s("input",{id:"creat-account","onUpdate:modelValue":a[5]||(a[5]=c=>e(n).createAccount=c),type:"checkbox",name:"creat-account"},null,512),[[X,e(n).createAccount]])]))])):y("",!0),e(r)==2?(m(),f(z,{key:1},[s("div",null,[s("h2",Ct,u(t.$t("messages.billing.billingDetails")),1),l(pe,{modelValue:e(o).billing,"onUpdate:modelValue":a[6]||(a[6]=c=>e(o).billing=c),sameAsShippingAddress:e(n).shipToDifferentAddress},null,8,["modelValue","sameAsShippingAddress"])]),s("label",At,[s("span",null,u(t.$t("messages.billing.differentAddress")),1),B(s("input",{id:"shipToDifferentAddress","onUpdate:modelValue":a[7]||(a[7]=c=>e(n).shipToDifferentAddress=c),type:"checkbox",name:"shipToDifferentAddress"},null,512),[[X,e(n).shipToDifferentAddress]])]),l(Q,{name:"scale-y",mode:"out-in"},{default:_(()=>[B(s("div",null,[s("h2",Vt,u(t.$t("messages.general.shippingDetails")),1),l(de,{modelValue:e(o).shipping,"onUpdate:modelValue":a[8]||(a[8]=c=>e(o).shipping=c)},null,8,["modelValue"])],512),[[ee,e(n).shipToDifferentAddress]])]),_:1}),e(p).availableShippingMethods.length?(m(),f("div",Bt,[s("h3",Dt,u(t.$t("messages.general.shippingSelect")),1),l(fe,{options:e(p).availableShippingMethods[0].rates,"active-option":e(p).chosenShippingMethods[0]},null,8,["options","active-option"])])):y("",!0)],64)):y("",!0),e(r)==3?(m(),f(z,{key:2},[e(b).nodes.length?(m(),f("div",Et,[s("h2",Mt,u(t.$t("messages.billing.paymentOptions")),1),l(ge,{modelValue:e(n).paymentMethod,"onUpdate:modelValue":a[9]||(a[9]=c=>e(n).paymentMethod=c),class:"mb-4",paymentGateways:e(b)},null,8,["modelValue","paymentGateways"]),e(x)?B((m(),L(_e,{key:0,stripe:e(x),onUpdateElement:S},null,8,["stripe"])),[[ee,e(n).paymentMethod.id=="stripe"]]):y("",!0)])):y("",!0)],64)):y("",!0),e(r)==4?(m(),f(z,{key:3},[s("div",null,[s("h2",Tt,u(t.$t("messages.shop.orderNote"))+" ("+u(t.$t("messages.general.optional"))+")",1),B(s("textarea",{id:"order-note","onUpdate:modelValue":a[10]||(a[10]=c=>e(n).customerNote=c),name:"order-note",class:"w-full",rows:"4",placeholder:t.$t("messages.shop.orderNotePlaceholder")},null,8,It),[[q,e(n).customerNote]])]),l(he,null,{default:_(()=>[s("button",{class:"flex items-center justify-center w-full gap-3 p-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark disabled:cursor-not-allowed disabled:bg-gray-400",disabled:e(T)},[R(u(e(M))+" ",1),e(w)?(m(),L(N,{key:0,color:"#fff",size:"18"})):y("",!0)],8,Pt)]),_:1})],64)):y("",!0)]),l(ve,{class:"sticky bottom-0 myglass"},{default:_(()=>[l(ye,null,{default:_(()=>[l(K,{onClick:ce,disabled:e(r)===1},{icon:_(()=>[l(h,{icon:"ion:arrow-back"})]),_:1},8,["disabled"]),l(K,{onClick:re,disabled:e(r)===4},{icon:_(()=>[l(h,{icon:"ion:arrow-forward"})]),_:1},8,["disabled"])]),_:1})]),_:1})],32))],64)):(m(),L(N,{key:0,class:"m-auto"}))])}}});export{Ht as default};
