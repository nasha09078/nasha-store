import{d as E,x as M,q as T,y as C,X as H,s as c,J as U,o as u,c as y,i as o,b as r,bv as j,t,j as w,B as k,e as a,w as x,g as $,k as D,h as v,a2 as S,n as z,l as A,D as N}from"./D2h1M-6X.js";import{_ as J}from"./DvU2Yq2X.js";const K={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},W={class:"flex flex-col items-center"},X={class:"text-xl font-semibold lg:text-3xl"},F={for:"password",class:"mb-4"},G={for:"confirmPassword",class:"mb-4"},O={key:0,class:"text-sm mb-4"},Q=["innerHTML"],Y={class:"flex items-center justify-center gap-4 mt-4 text-lg"},Z={class:"my-8 text-center cursor-pointer"},ss=E({__name:"ResetPassword",setup(V){const{t:n}=M(),_=T(),h=C(),{viewer:L,resetPasswordWithKey:R,loginUser:q}=H(),l=c(""),i=c(""),d=c(""),p=c(!1),m=c(!1),I=async()=>{try{if(d.value="",m.value=!1,p.value=!0,l.value!==i.value)throw new Error(n("messages.error.passwordMismatch"));const e={key:h.query.key,login:h.query.login,password:l.value};if(!e.key||!e.login)throw m.value=!0,new Error(n("messages.error.invalidPasswordResetLink"));const s=await R(e);if(!s.success)throw m.value=!0,new Error(s.error);if(L.value){const f=await q({username:e.login,password:e.password});if(!f.success)throw new Error(f.error)}_.push("/my-account")}catch(e){d.value=e.message||n("messages.error.general")}finally{p.value=!1}};return U({title:n("messages.account.resetPassword")}),(e,s)=>{const f=j,P=J,b=D,B=z;return u(),y("div",K,[o("div",W,[r(f,{class:"mb-6 scale-125"}),o("h1",X,t(e.$t("messages.account.resetPassword")),1)]),o("form",{class:"mt-6 flex flex-col",onSubmit:A(I,["prevent"])},[o("label",F,[w(t(e.$t("messages.account.newPassword"))+" ",1),s[2]||(s[2]=o("span",{class:"text-red-500"},"*",-1)),s[3]||(s[3]=o("br",null,null,-1)),r(P,{id:"password",className:" border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(l),"onUpdate:modelValue":s[0]||(s[0]=g=>k(l)?l.value=g:null),placeholder:"New Password",required:!0},null,8,["modelValue"])]),o("label",G,[w(t(e.$t("messages.account.confirmNewPassword"))+" ",1),s[4]||(s[4]=o("span",{class:"text-red-500"},"*",-1)),s[5]||(s[5]=o("br",null,null,-1)),r(P,{id:"confirmPassword",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(i),"onUpdate:modelValue":s[1]||(s[1]=g=>k(i)?i.value=g:null),placeholder:"Confirm Password",required:!0},null,8,["modelValue"])]),r(S,{name:"scale-y",mode:"out-in"},{default:x(()=>[a(d)?(u(),y("div",O,[o("span",{class:"text-red-500",innerHTML:a(d)},null,8,Q),a(m)?(u(),$(b,{key:0,class:"underline cursor-pointer pl-1",to:"/my-account?action=forgotPassword"},{default:x(()=>[w(t(e.$t("messages.account.requestNewLink")),1)]),_:1})):v("",!0)])):v("",!0)]),_:1}),o("button",Y,[a(p)?(u(),$(B,{key:0,stroke:"4",size:"16",color:"#fff"})):v("",!0),o("span",null,t(e.$t("messages.account.resetPassword")),1)])],32),o("div",Z,[r(b,{to:"/my-account"},{default:x(()=>[w(t(e.$t("messages.account.backToLogin")),1)]),_:1})])])}}}),es=N(ss,[["__scopeId","data-v-08494209"]]),os={},ts={class:"container min-h-[600px]"};function as(V,n){const _=es;return u(),y("div",ts,[r(_)])}const ls=N(os,[["render",as]]);export{ls as default};
