import{_ as ne,a as oe}from"./GQHXd0SH.js";import{as as Z,X as Q,u as S,at as he,q as ye,v as ge,au as ve,H as $e,av as be,aw as H,o as _,c as y,i as e,t as m,$ as v,a0 as $,e as t,b,T as O,D as le,Y as we,F as M,r as E,a1 as ae,f as G,d as R,L as re,g as L,h as C,s as ee,B as Ce,n as ie,l as xe,w as N,a2 as A,j as Se,ax as Ve}from"./D2h1M-6X.js";import{_ as ke}from"./CTsXp8GV.js";const Le=window.setInterval;function j(){const c=Z("orderInput",()=>({customerNote:"",paymentMethod:"",shipToDifferentAddress:!1,metaData:[{key:"order_via",value:"WooNuxt"}]})),n=Z("isProcessingOrder",()=>!1);async function a(){var f;const{customer:o,viewer:s}=Q(),{isUpdatingCart:l,refreshCart:r}=S();l.value=!0;try{const{updateCustomer:p}=await he({input:{id:(f=s==null?void 0:s.value)==null?void 0:f.id,shipping:c.value.shipToDifferentAddress?o.value.shipping:o.value.billing,billing:o.value.billing}});p&&r()}catch(p){console.error(p)}}function i(o){return new Promise(s=>{const f=window.innerWidth/2-375,p=window.innerHeight/2-750/2+80,d=window.open(o,"",`width=750,height=750,top=${p},left=${f}`),g=Le(()=>{d!=null&&d.closed&&(clearInterval(g),s(!0))},500)})}return{orderInput:c,isProcessingOrder:n,proccessCheckout:async(o=!1)=>{var B,W,F,X,Y;const{customer:s,loginUser:l}=Q(),r=ye(),{replaceQueryParam:f}=ge(),{emptyCart:p,refreshCart:d}=S();n.value=!0;const{username:g,password:T,shipToDifferentAddress:q}=c.value,z=(B=s.value)==null?void 0:B.billing,pe=q?(W=s.value)==null?void 0:W.shipping:z;try{let x={billing:z,shipping:pe,metaData:c.value.metaData,paymentMethod:c.value.paymentMethod.id,customerNote:c.value.customerNote,shipToDifferentAddress:q,transactionId:c.value.transactionId,isPaid:o};c.value.createAccount&&(x.account={username:g,password:T});const{checkout:h}=await ve(x);c.value.createAccount&&await l({username:g,password:T});const I=(F=h==null?void 0:h.order)==null?void 0:F.databaseId,D=(X=h==null?void 0:h.order)==null?void 0:X.orderKey,J=c.value.paymentMethod.id,me=J==="paypal"||J==="ppcp-gateway";if(await(h==null?void 0:h.redirect)&&me){const K=window.location.origin;let w=(h==null?void 0:h.redirect)??"";const fe=`${K}/checkout/order-received/${I}/?key=${D}&from_paypal=true`,_e=`${K}/checkout/?cancel_order=true&from_paypal=true`;w=f("return",fe,w),w=f("cancel_return",_e,w),w=f("bn","WooNuxt_Cart",w),await i(w)&&r.push(`/checkout/order-received/${I}/?key=${D}&fetch_delay=true`)}else r.push(`/checkout/order-received/${I}/?key=${D}`);if(await(h==null?void 0:h.result)!=="success")return alert("There was an error processing your order. Please try again."),window.location.reload(),h;await p(),await d()}catch(x){n.value=!1;const h=(Y=x==null?void 0:x.gqlErrors)==null?void 0:Y[0].message;return h!=null&&h.includes("An account is already registered with your email address")?(alert("An account is already registered with your email address"),null):(alert(h),null)}n.value=!1},updateShippingLocation:a}}const Te={class:"grid w-full gap-4 lg:grid-cols-2"},Pe={class:"w-full"},Ue={for:"first-name"},Me={class:"w-full"},Ee={for:"last-name"},qe={class:"w-full col-span-full"},Ie={for:"address1"},De={class:"w-full col-span-full"},Ne={for:"address2"},Ae={class:"w-full"},je={for:"city"},He={class:"w-full"},Oe={for:"state"},Ge={class:"w-full"},Re={for:"country"},ze={class:"w-full"},Be={for:"zip"},We={class:"w-full col-span-full"},Fe={for:"phone"},is={__name:"BillingDetails",props:{modelValue:{type:Object,required:!0},sameAsShippingAddress:{type:Boolean,default:!0}},async setup(c){let n,a;const{allowedCountries:i}=([n,a]=$e(()=>be({country:"IE"})),n=await n,a(),n),{updateShippingLocation:u}=j(),s=H(c,"modelValue");return(l,r)=>{const f=ne,p=oe;return _(),y("div",Te,[e("div",Pe,[e("label",Ue,m(l.$t("messages.billing.firstName")),1),v(e("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>t(s).firstName=d),placeholder:"John",type:"text",required:""},null,512),[[$,t(s).firstName]])]),e("div",Me,[e("label",Ee,m(l.$t("messages.billing.lastName")),1),v(e("input",{"onUpdate:modelValue":r[1]||(r[1]=d=>t(s).lastName=d),placeholder:"Doe",type:"text",required:""},null,512),[[$,t(s).lastName]])]),e("div",qe,[e("label",Ie,m(l.$t("messages.billing.address1")),1),v(e("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>t(s).address1=d),placeholder:"O'Connell Street",type:"text",required:""},null,512),[[$,t(s).address1]])]),e("div",De,[e("label",Ne,m(l.$t("messages.billing.address2")),1),v(e("input",{"onUpdate:modelValue":r[3]||(r[3]=d=>t(s).address2=d),placeholder:"Dublin 1",type:"text"},null,512),[[$,t(s).address2]])]),e("div",Ae,[e("label",je,m(l.$t("messages.billing.city")),1),v(e("input",{"onUpdate:modelValue":r[4]||(r[4]=d=>t(s).city=d),placeholder:"Dublin",type:"text",required:""},null,512),[[$,t(s).city]])]),e("div",He,[e("label",Oe,m(l.$t("messages.billing.state")),1),b(f,{modelValue:t(s).state,"onUpdate:modelValue":r[5]||(r[5]=d=>t(s).state=d),"default-value":t(s).state,"country-code":t(s).country,onChange:t(u)},null,8,["modelValue","default-value","country-code","onChange"])]),e("div",Ge,[e("label",Re,m(l.$t("messages.billing.country")),1),b(p,{modelValue:t(s).country,"onUpdate:modelValue":r[6]||(r[6]=d=>t(s).country=d),"default-value":t(s).country,onChange:t(u)},null,8,["modelValue","default-value","onChange"])]),e("div",ze,[e("label",Be,"ZIP ("+m(l.$t("messages.general.optional"))+")",1),v(e("input",{"onUpdate:modelValue":r[7]||(r[7]=d=>t(s).postcode=d),placeholder:"D01 1234",type:"text"},null,512),[[$,t(s).postcode]])]),e("div",We,[e("label",Fe,m(l.$t("messages.billing.phone"))+" ("+m(l.$t("messages.general.optional"))+")",1),v(e("input",{"onUpdate:modelValue":r[8]||(r[8]=d=>t(s).phone=d),placeholder:"+353871234567",type:"tel"},null,512),[[$,t(s).phone]])])])}}},Xe={class:"grid w-full gap-4 lg:grid-cols-2"},Ye={class:"w-full"},Je={for:"first-name"},Ke=["required"],Ze={class:"w-full"},Qe={for:"last-name"},et=["required"],tt={class:"w-full col-span-full"},st={for:"address1"},nt=["required"],ot={class:"w-full col-span-full"},lt={for:"address2"},at={class:"w-full"},rt={for:"city"},it=["required"],dt={class:"w-full"},ut={for:"zip"},ct={class:"w-full"},pt={for:"state"},mt={class:"w-full"},ft={for:"country"},_t={class:"w-full col-span-full"},ht={for:"phone"},ds={__name:"ShippingDetails",props:{modelValue:{type:Object,required:!0}},setup(c){const{updateShippingLocation:n}=j(),{orderInput:a}=j(),i=O(()=>a.value.shipToDifferentAddress),o=H(c,"modelValue");return(s,l)=>{const r=ne,f=oe;return _(),y("div",Xe,[e("div",Ye,[e("label",Je,m(s.$t("messages.billing.firstName")),1),v(e("input",{"onUpdate:modelValue":l[0]||(l[0]=p=>t(o).firstName=p),placeholder:"John",type:"text",required:t(i)},null,8,Ke),[[$,t(o).firstName]])]),e("div",Ze,[e("label",Qe,m(s.$t("messages.billing.lastName")),1),v(e("input",{"onUpdate:modelValue":l[1]||(l[1]=p=>t(o).lastName=p),placeholder:"Doe",type:"text",required:t(i)},null,8,et),[[$,t(o).lastName]])]),e("div",tt,[e("label",st,m(s.$t("messages.billing.address1")),1),v(e("input",{"onUpdate:modelValue":l[2]||(l[2]=p=>t(o).address1=p),placeholder:"O'Connell Street",type:"text",required:t(i)},null,8,nt),[[$,t(o).address1]])]),e("div",ot,[e("label",lt,m(s.$t("messages.billing.address2")),1),v(e("input",{"onUpdate:modelValue":l[3]||(l[3]=p=>t(o).address2=p),placeholder:"Dublin 1",type:"text"},null,512),[[$,t(o).address2]])]),e("div",at,[e("label",rt,m(s.$t("messages.billing.city")),1),v(e("input",{"onUpdate:modelValue":l[4]||(l[4]=p=>t(o).city=p),placeholder:"Dublin",type:"text",required:t(i)},null,8,it),[[$,t(o).city]])]),e("div",dt,[e("label",ut,"ZIP ("+m(s.$t("messages.general.optional"))+")",1),v(e("input",{"onUpdate:modelValue":l[5]||(l[5]=p=>t(o).postcode=p),placeholder:"D01 1234",type:"text"},null,512),[[$,t(o).postcode]])]),e("div",ct,[e("label",pt,m(s.$t("messages.billing.state")),1),b(r,{modelValue:t(o).state,"onUpdate:modelValue":l[6]||(l[6]=p=>t(o).state=p),"default-value":t(o).state,"country-code":t(o).country,onChange:t(n)},null,8,["modelValue","default-value","country-code","onChange"])]),e("div",mt,[e("label",ft,m(s.$t("messages.billing.country")),1),b(f,{modelValue:t(o).country,"onUpdate:modelValue":l[7]||(l[7]=p=>t(o).country=p),"default-value":t(o).country,onChange:t(n)},null,8,["modelValue","default-value","onChange"])]),e("div",_t,[e("label",ht,m(s.$t("messages.billing.phone"))+" ("+m(s.$t("messages.general.optional"))+")",1),v(e("input",{"onUpdate:modelValue":l[8]||(l[8]=p=>t(o).phone=p),placeholder:"+353871234567",type:"tel"},null,512),[[$,t(o).phone]])])])}}},yt={class:"grid gap-4 shipping-options"},gt=["onClick"],vt=["innerHTML"],$t={class:"font-semibold text-gray-600"},bt={__name:"ShippingOptions",props:{options:{type:Array,required:!0},activeOption:{type:String,required:!0}},setup(c){var o;const{updateShippingMethod:n}=S(),a=we(),i=((o=a==null?void 0:a.public)==null?void 0:o.CURRENCY_SYMBOL)||"$",u=async s=>{await n(s)};return(s,l)=>{const r=G;return _(),y("div",yt,[(_(!0),y(M,null,E(c.options,f=>(_(),y("div",{key:f.id,class:ae(["flex items-center justify-between option",{"active-option":f.id===c.activeOption}]),onClick:p=>u(f.id)},[e("div",null,[e("div",{class:"text-sm leading-tight text-gray-500",innerHTML:f.label},null,8,vt),e("div",$t,m(t(i))+m(f.cost),1)]),b(r,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,gt))),128))])}}},us=le(bt,[["__scopeId","data-v-9d8db43b"]]),wt={class:"flex gap-4 leading-tight flex-wrap"},Ct=["onClick","title"],xt=["innerHTML"],St={key:0,class:"prose block w-full"},Vt=["innerHTML"],kt=R({__name:"PaymentOptions",props:{modelValue:{},paymentGateways:{}},emits:["update:modelValue"],setup(c,{emit:n}){const a=c,i=H(a,"modelValue"),u=O(()=>i.value),o=n,s=l=>{o("update:modelValue",l)};return re(()=>{var l,r;(l=a.paymentGateways)!=null&&l.nodes.length&&s((r=a.paymentGateways)==null?void 0:r.nodes[0])}),(l,r)=>{var p;const f=G;return _(),y("div",wt,[(_(!0),y(M,null,E((p=l.paymentGateways)==null?void 0:p.nodes,d=>(_(),y("div",{key:d.id,class:ae(["option",{"active-option":d.id===t(u).id}]),onClick:g=>s(d),title:(d==null?void 0:d.description)||(d==null?void 0:d.title)||"Payment Method"},[d.id==="stripe"?(_(),L(f,{key:0,name:"ion:card-outline",size:"20"})):d.id==="paypal"?(_(),L(f,{key:1,name:"ion:logo-paypal",size:"20"})):(_(),L(f,{key:2,name:"ion:cash-outline",size:"20"})),e("span",{class:"whitespace-nowrap",innerHTML:d.title},null,8,xt),b(f,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,Ct))),128)),t(u).description?(_(),y("div",St,[e("p",{class:"text-sm text-gray-500",innerHTML:t(u).description},null,8,Vt)])):C("",!0)])}}}),cs=le(kt,[["__scopeId","data-v-01e33632"]]),Lt={id:"card-element"},ps=R({__name:"StripeElement",props:["stripe"],emits:["updateElement"],setup(c,{emit:n}){const{cart:a}=S(),i=O(()=>a.value&&parseFloat(a.value.rawTotal)*100),u=n;let o=null;const s={mode:"payment",currency:"eur",amount:i.value},l=async()=>{o=c.stripe.elements(s),o.create("card",{hidePostalCode:!0}).mount("#card-element"),u("updateElement",o)};return re(()=>{l()}),(r,f)=>(_(),y("div",Lt))}}),Tt=["placeholder"],Pt=["disabled"],Ut={key:1},Mt=["innerHTML"],Et={key:0,class:"text-xs font-semibold uppercase flex flex-wrap gap-2"},qt={key:0,class:"bg-primary border-primary border rounded-md flex bg-opacity-5 border-opacity-10 text-primary leading-none p-1.5 gap-1 items-center"},It=["innerHTML"],Dt=R({__name:"AddCoupon",setup(c){const{cart:n,isUpdatingCoupon:a,applyCoupon:i,removeCoupon:u}=S(),o=ee(""),s=ee("");async function l(){const{message:r}=await i(o.value);r?s.value=r:(o.value="",s.value="")}return(r,f)=>{const p=ie,d=G;return _(),y("div",null,[e("form",{class:"flex gap-1",onSubmit:xe(l,["prevent"])},[v(e("input",{id:"couponCode","onUpdate:modelValue":f[0]||(f[0]=g=>Ce(o)?o.value=g:null),type:"text",placeholder:r.$t("messages.shop.couponCode"),class:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm outline-none",required:""},null,8,Tt),[[$,t(o)]]),e("button",{class:"flex items-center justify-center px-4 py-2 text-white bg-gray-800 border rounded-md shadow-sm outline-none min-w-20",disabled:t(a)},[t(a)?(_(),L(p,{key:0,color:"#fff",size:"16"})):(_(),y("span",Ut,m(r.$t("messages.general.apply")),1))],8,Pt)],32),b(A,{name:"scale-y",mode:"out-in"},{default:N(()=>[t(s)?(_(),y("div",{key:0,class:"mt-2 text-xs text-red-600",innerHTML:t(s)},null,8,Mt)):C("",!0)]),_:1}),b(A,{name:"scale-y",mode:"out-in"},{default:N(()=>[t(n)&&t(n).appliedCoupons?(_(),y("div",Et,[(_(!0),y(M,null,E(t(n).appliedCoupons,(g,T)=>(_(),y("div",{key:(g==null?void 0:g.code)||T,class:"flex flex-wrap mt-2 flex-2"},[g!=null&&g.code?(_(),y("div",qt,[e("span",{innerHTML:g.code},null,8,It),b(d,{name:"ion:close",class:"rounded-full cursor-pointer hover:bg-primary hover:text-white",onClick:q=>t(u)(g.code)},null,8,["onClick"])])):C("",!0)]))),128))])):C("",!0)]),_:1})])}}}),Nt={key:0,class:"bg-white rounded-lg shadow-lg mb-8 w-full min-h-[280px] p-4 sm:p-8 relative md:max-w-md md:top-32 md:sticky"},At={class:"mb-6 text-xl font-semibold leading-none"},jt={class:"flex flex-col gap-4 overflow-y-auto"},Ht={class:"grid gap-1 text-sm font-semibold text-gray-500"},Ot={class:"flex justify-between"},Gt=["innerHTML"],Rt={class:"flex justify-between"},zt={class:"text-gray-700 tabular-nums"},Bt={key:0,class:"flex justify-between"},Wt={class:"text-primary tabular-nums"},Ft=["innerHTML"],Xt={class:"flex justify-between mt-4"},Yt=["innerHTML"],Jt={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-50"},ms={__name:"OrderSummary",setup(c){const{cart:n,isUpdatingCart:a}=S();return(i,u)=>{const o=ke,s=Dt,l=ie;return t(n)?(_(),y("aside",Nt,[e("h2",At,m(i.$t("messages.shop.orderSummary")),1),e("ul",jt,[(_(!0),y(M,null,E(t(n).contents.nodes,r=>(_(),L(o,{key:r.key,item:r},null,8,["item"]))),128))]),b(s,{class:"my-8"}),e("div",Ht,[e("div",Ot,[e("span",null,m(i.$t("messages.shop.subtotal")),1),e("span",{class:"text-gray-700 tabular-nums",innerHTML:t(n).subtotal},null,8,Gt)]),e("div",Rt,[e("span",null,m(i.$t("messages.general.shipping")),1),e("span",zt,m(parseFloat(t(n).shippingTotal)>0?"+":"")+" "+m(t(n).shippingTotal),1)]),b(A,{name:"scale-y",mode:"out-in"},{default:N(()=>[t(n)&&t(n).appliedCoupons?(_(),y("div",Bt,[e("span",null,m(i.$t("messages.shop.discount")),1),e("span",Wt,[u[0]||(u[0]=Se("- ")),e("span",{innerHTML:t(n).discountTotal},null,8,Ft)])])):C("",!0)]),_:1}),e("div",Xt,[e("span",null,m(i.$t("messages.shop.total")),1),e("span",{class:"text-lg font-bold text-gray-700 tabular-nums",innerHTML:t(n).total},null,8,Yt)])]),Ve(i.$slots,"default"),t(a)?(_(),y("div",Jt,[b(l)])):C("",!0)])):C("",!0)}}};var de="https://js.stripe.com/v3",Kt=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,te="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Zt=function(){for(var n=document.querySelectorAll('script[src^="'.concat(de,'"]')),a=0;a<n.length;a++){var i=n[a];if(Kt.test(i.src))return i}return null},se=function(n){var a="",i=document.createElement("script");i.src="".concat(de).concat(a);var u=document.head||document.body;if(!u)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return u.appendChild(i),i},Qt=function(n,a){!n||!n._registerWrapper||n._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:a})},V=null,P=null,U=null,es=function(n){return function(){n(new Error("Failed to load Stripe.js"))}},ts=function(n,a){return function(){window.Stripe?n(window.Stripe):a(new Error("Stripe.js not available"))}},ss=function(n){return V!==null?V:(V=new Promise(function(a,i){if(typeof window>"u"||typeof document>"u"){a(null);return}if(window.Stripe&&n&&console.warn(te),window.Stripe){a(window.Stripe);return}try{var u=Zt();if(u&&n)console.warn(te);else if(!u)u=se(n);else if(u&&U!==null&&P!==null){var o;u.removeEventListener("load",U),u.removeEventListener("error",P),(o=u.parentNode)===null||o===void 0||o.removeChild(u),u=se(n)}U=ts(a,i),P=es(i),u.addEventListener("load",U),u.addEventListener("error",P)}catch(s){i(s);return}}),V.catch(function(a){return V=null,Promise.reject(a)}))},ns=function(n,a,i){if(n===null)return null;var u=n.apply(void 0,a);return Qt(u,i),u},k,ue=!1,ce=function(){return k||(k=ss(null).catch(function(n){return k=null,Promise.reject(n)}),k)};Promise.resolve().then(function(){return ce()}).catch(function(c){ue||console.warn(c)});var fs=function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];ue=!0;var u=Date.now();return ce().then(function(o){return ns(o,a,u)})};export{is as _,ds as a,us as b,cs as c,ps as d,ms as e,fs as l,j as u};
